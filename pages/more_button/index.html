<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>もっとみるボタン</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <h1>もっとみるボタン</h1>

        <div class="wrap">
            <div class="txt-upper">
                ここにデフォルトで表示するテキストを入力します。ここにデフォルトで表示するテキストを入力します。ここにデフォルトで表示するテキストを入力します。
                ここにデフォルトで表示するテキストを入力します。ここにデフォルトで表示するテキストを入力します。ここにデフォルトで表示するテキストを入力します。
                ここにデフォルトで表示するテキストを入力します。ここにデフォルトで表示するテキストを入力します。ここにデフォルトで表示するテキストを入力します。
                ここにデフォルトで表示するテキストを入力します。ここにデフォルトで表示するテキストを入力します。ここにデフォルトで表示するテキストを入力します。
                ここにデフォルトで表示するテキストを入力します。ここにデフォルトで表示するテキストを入力します。ここにデフォルトで表示するテキストを入力します。
                ここにデフォルトで表示するテキストを入力します。ここにデフォルトで表示するテキストを入力します。ここにデフォルトで表示するテキストを入力します。
                ここにデフォルトで表示するテキストを入力します。ここにデフォルトで表示するテキストを入力します。ここにデフォルトで表示するテキストを入力します。
            </div>
            <div class="txt-under is-open">
                あああああああああああああああああああああああああああああああああああああああああ
                あああああああああああああああああああああああああああああああああああああああああ
                あああああああああああああああああああああああああああああああああああああああああ
                あああああああああああああああああああああああああああああああああああああああああ
                あああああああああああああああああああああああああああああああああああああああああ
                あああああああああああああああああああああああああああああああああああああああああ
                あああああああああああああああああああああああああああああああああああああああああ
                あああああああああああああああああああああああああああああああああああああああああ
                あああああああああああああああああああああああああああああああああああああああああ
            </div>
            <p class="more-button hidden">
                <span class="more">もっとみる</span>
            </p>
        </div>

    </body>
    <script>
        var flg = false
        var isOpen = true
        const thresholdWidth = 600;

        $(document).ready(function(){
            checkWidth();

            $(window).resize(function(){
                checkWidth();
            });

            $(".more-button").on("click", function() {
                isOpen = !isOpen

                if(isOpen) {
                    $(".txt-under").addClass("is-open");
                    $(".more").text("とじる");
                } else {
                    $(".txt-under").removeClass("is-open");
                    $(".more").text("もっとみる");
                }
            });
        });

        function checkWidth() {
            var windowWidth = $(window).width();

            if(windowWidth < thresholdWidth) {
                $(".more-button").removeClass("hidden");

                if(flg === false) {
                    $(".txt-under").removeClass("is-open");
                    flg = true
                    isOpen = false
                }
            }
            
            if(windowWidth > thresholdWidth) {
                $(".more-button").addClass("hidden");
                $(".txt-under").addClass("is-open");
                flg = false
                isOpen = true

                $(".more").text("もっとみる");
            }
            
        }
    </script>
</html>